# 機能提案: デザイン改修 & ナイトモード

## 1. 目的

本機能提案は、以下の2つの目的を達成します。

*   **視認性の向上**: アプリケーション全体の配色を見直し、特にボタンと背景のコントラストを改善することで、より直感的で分かりやすいUIを実現します。過度な装飾ではなく、見やすさを最優先します。
*   **ナイトモードの実装**: 暗い環境での目の負担を軽減し、ユーザーの好みに合わせたテーマ選択を可能にする「ナイトモード（ダークテーマ）」を新たに導入します。

## 2. 主な変更点

*   **ライトモードの配色改善**: 現在のデフォルトテーマ（ライトモード）の配色を調整し、要素間の境界をより明確にします。特に「白背景に白ボタン」問題を解決します。
*   **ナイトモードの新規導入**: 黒を基調とした新しい配色（ダークテーマ）を追加し、ユーザーが手動で切り替えられるようにします。
*   **テーマ切り替え機能**: ライトモードとナイトモードを切り替えるためのUI（トグルスイッチ）をヘッダーに追加します。

## 3. 技術的アプローチ: テーマ管理システム

### 3.1. CSSカスタムプロパティ（変数）の活用
プロジェクトは既にCSS変数を広範に使用しており、このシステムを最大限に活用します。

*   **二つのテーマセット**: ライトテーマ用の変数セットと、ナイトテーマ用の変数セットを `index_tomomi.css` 内で定義します。
*   **セレクタ**: `html` または `body` 要素に `dark-theme` クラスが付与されている場合に、ナイトテーマ用のCSS変数が上書きされるように設定します。

### 3.2. テーマの切り替えロジック
*   **トグルスイッチ**: ヘッダーに新設するナイトモード切り替え用のトグルスイッチにイベントリスナーを設定します。
*   **クラスの付け外し**: トグルスイッチの状態に応じて、JavaScriptが `document.documentElement` (または `document.body`) の `dark-theme` クラスを付け外しします。
*   **設定の永続化**: ユーザーが選択したテーマ設定（ライトまたはダーク）は、ブラウザの `localStorage` に保存します。次回アプリケーション起動時に `localStorage` から設定を読み込み、自動的に前回のテーマを適用します。

## 4. デザイン改修案

### 4.1. ライトモード（コントラスト改善）

現在のテーマ（デフォルト）の視認性向上のため、以下の配色調整を行います。

| CSS変数            | 現行値     | 提案値     | 目的                                          |
| :----------------- | :--------- | :--------- | :-------------------------------------------- |
| `--bg`             | `#f8fafc`  | `#f7f8f9`  | 全体背景を微調整し、白いカードの視認性を向上    |
| `--card-bg`        | `#ffffff`  | `#ffffff`  | カード背景は白を維持し、背景とのコントラスト確保 |
| `--card-border`    | `#e2e8f0`  | `#d1d5db`  | 境界線を少し濃くし、要素の区切りを明確に         |
| `--text-main`      | `#1e293b`  | `#1e293b`  | メインテキストは現状維持                      |
| `--text-sub`       | `#64748b`  | `#64748b`  | サブテキストは現状維持                        |
| `--primary`        | `#3b82f6`  | `#3b82f6`  | プライマリカラーは現状維持                    |
| `--primary-dark`   | `#2563eb`  | `#2563eb`  | ホバー時のプライマリカラーは現状維持          |
| `--secondary-btn`  | `#ffffff`  | `#f0f4f8`  | 白背景のボタンに薄いグレーの背景を適用し、視認性向上 |
| `--secondary-btn-hover`| `#f1f5f9` | `#e2e8f0` | ホバー時のセカンダリボタン背景色               |

### 4.2. ナイトモード（新規）

`html` (または `body`) に `dark-theme` クラスが付与された際に適用される、新しい配色を定義します。

| CSS変数            | 提案値     | 説明                                            |
| :----------------- | :--------- | :---------------------------------------------- |
| `--bg`             | `#1a202c`  | 全体背景：暗い環境での目の負担を軽減              |
| `--card-bg`        | `#2d3748`  | カード背景：背景よりわずかに明るいグレー          |
| `--card-border`    | `#4a5568`  | カード境界線：控えめな境界線色                  |
| `--card-hover`     | `#4a5568`  | カードホバー：背景と調和するグレー              |
| `--primary`        | `#63b3ed`  | プライマリカラー：ダーク背景で視認性の良い青      |
| `--primary-dark`   | `#4299e1`  | ホバー時のプライマリカラー                      |
| `--text-main`      | `#e2e8f0`  | メインテキスト：明るいグレー                      |
| `--text-sub`       | `#a0aec0`  | サブテキスト：やや暗めのグレー                    |
| `--danger`         | `#f56565`  | 危険色：ダークテーマでも目立つ赤                  |
| `--secondary-btn`  | `#4a5568`  | セカンダリボタン：ダークテーマに合うグレー        |
| `--secondary-btn-hover`| `#667eea` | セカンダリボタンホバー：青みがかったグレー        |

*   **リソース別カラー (`--color-video` など)**:
    *   既存の色をベースに、ダークテーマで視認性が確保できる明るさに調整します。
        *   `--color-video`: `#f6e0b5` (現在の赤系から黄系に調整)
        *   `--color-doc`: `#9ae6b4` (現在の緑系から調整)
        *   `--color-article`: `#fbd38d` (現在の黄系から調整)
        *   `--color-portal`: `#a78bfa` (現在の紫系から調整)
        *   `--color-code`: `#cbd5e1` (現在の灰系から調整)

## 5. UIの変更

*   **ヘッダーへのトグルスイッチ追加**:
    *   `index_tomomi.html` のヘッダーにある既存の「編集モード」トグルスイッチの隣に、ナイトモード切り替え用の新しいトグルスイッチを追加します。デザインは「編集モード」スイッチに準拠します。
*   **JSによる制御**:
    *   `js/ui.js` 内で、新しいトグルスイッチのイベントリスナーを設定し、`<body>` 要素の `dark-theme` クラスの付け外しを行います。
    *   `js/app.js` または `js/ui.js` の起動時に `localStorage` からテーマ設定を読み込み、適用するロジックを追加します。

## 6. 影響範囲

*   `index_tomomi.html`: ナイトモード切り替えスイッチの追加。
*   `index_tomomi.css`: CSSカスタムプロパティの再定義と、`dark-theme` クラス適用時のスタイル定義。
*   `js/app.js` / `js/ui.js`: テーマ設定の読み込み・保存ロジックと、トグルスイッチのイベントハンドリングを追加。

この提案は、ユーザーからのフィードバックに基づき、見やすさを改善しつつ、モダンな機能を追加するものです。
