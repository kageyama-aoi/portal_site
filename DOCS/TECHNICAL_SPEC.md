# Study Portal 技術仕様書

このドキュメントでは、Study Portal（勉強用リンク集）で使用されている技術的アプローチ、アーキテクチャ、および実装の詳細について解説します。

## 1. アーキテクチャ概要

本アプリケーションは、**サーバーレス・クライアントサイドレンダリング** アプローチを採用したシングルページアプリケーション（SPA）です。

*   **データ駆動 (Data-Driven)**: UIはすべて `data.json` という外部設定ファイルに基づいて動的に生成されます。HTMLを直接編集する必要はありません。
*   **フレームワークレス (Vanilla JS)**: ReactやVueなどの外部フレームワークを使用せず、標準的なJavaScriptのみで構築されているため、軽量で依存関係がありません。
*   **ローカルファースト & Gitフレンドリー**: データの実体はJSONファイルであり、変更は「ファイルのダウンロード（上書き）」という形で永続化されます。これにより、Gitでのバージョン管理との親和性を高めています。

## 2. ファイル構成

```text
MyPotalSite/
├── index_tomomi.html  ... アプリケーションのエントリーポイント（HTML構造）
├── index_tomomi.css   ... スタイル定義（CSS変数、レスポンシブ設定）
├── index_tomomi.js    ... アプリケーションロジック（描画、データ操作、イベント）
└── data.json          ... リンク集のデータソース（JSON形式）
```

## 3. 実装テクニック詳細

### 3.1. データ管理と永続化フロー
ブラウザのセキュリティ制約（ローカルファイルの直接書き込み禁止）を回避しつつ、データの保存を実現するために以下の手法を採用しています。

*   **読み込み (Fetch API)**:
    *   起動時に `fetch('data.json')` を実行し、非同期でデータを取得してオンメモリに展開します。
*   **保存 (Blob & Download)**:
    *   編集後のデータオブジェクトを `JSON.stringify` で文字列化。
    *   `new Blob([...], { type: 'application/json' })` でバイナリデータ化。
    *   `URL.createObjectURL(blob)` で一時的なダウンロードURLを生成。
    *   隠し `<a>` タグを動的に生成・クリックさせることで、ブラウザのダウンロード機能をトリガーし、ファイルを生成します。

### 3.2. UI/UX コンポーネント技術
ブラウザ標準の機能を最大限活用することで、外部ライブラリなしでリッチなUIを実現しています。

*   **アコーディオンUI**:
    *   JavaScriptで開閉を制御するのではなく、HTML5標準の `<details>` と `<summary>` タグを使用。ブラウザネイティブの挙動を利用することで、アクセシビリティとパフォーマンスを確保しています。
*   **モーダルダイアログ**:
    *   `div` を重ねる古典的な手法ではなく、HTML5標準の `<dialog>` 要素を使用。
    *   `.showModal()` メソッドを呼ぶだけで、背景のバックドロップ処理やフォーカス制御が自動的に行われます。
*   **トグルスイッチ**:
    *   `<input type="checkbox">` と CSSの `::before` 疑似要素、`transition` を組み合わせることで、iOS風のスイッチをCSSのみで描画しています。

### 3.3. スタイリング (CSS設計)
*   **CSS Variables (カスタムプロパティ)**:
    *   `:root` スコープで色やサイズを変数化（例: `--primary`, `--bg`）。これにより、テーマカラーの変更が一箇所で完了します。
*   **CSS Grid & Flexbox**:
    *   リンクカードの配置には `display: grid` と `repeat(auto-fit, minmax(280px, 1fr))` を使用。メディアクエリを多用せずとも、画面幅に応じて列数が自動調整されるレスポンシブデザインを実現しています。
*   **状態に応じたスタイリング**:
    *   親コンテナにクラスを付与するのではなく、JSの編集モードフラグに応じて要素の表示/非表示や、`.link-card.disabled` のようなクラス操作でインタラクション（クリック可否など）を制御しています。

### 3.4. リスト操作ロジック
ドラッグ＆ドロップなどの複雑なライブラリを使用せず、配列操作メソッドで順序変更を実装しています。

*   **要素の移動**:
    *   `moveCategory(index, direction)` 関数などで、配列のインデックスを操作（スワップ）し、即座に `render()` で再描画することで、直感的な並び替えを実現しています。

## 4. 拡張性とメンテナンス
*   **GitHub Pages対応**: 静的なファイル構成であるため、GitHub Pages等のホスティングサービスにプッシュするだけで即座にWebサイトとして公開可能です。
*   **バックアップ**: JSONファイルをコピーするだけでバックアップが可能。また、インポート機能により過去のJSONへのロールバックも容易です。
